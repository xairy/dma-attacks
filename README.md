DMA Attacks
===========

Materials for my "Introduction to PCIe and DMA attacks" talk.

Last iteration of the talk:

* [PHDays 2019](https://docs.google.com/presentation/d/1Hn9RGrp2DEuAqOfytizPtCm98qti0T5tlUb6jFs-068/edit?usp=sharing) [slides] [[video](https://www.youtube.com/watch?v=zY1VBtKVDi0)]

## Overview

[2020: "DMA explained"](https://astralvx.com/dma-explained/) [article]

[2017: "Practical introduction to PCI Express with FPGAs" by Michal Husejko and John Evans](https://indico.cern.ch/event/121654/attachments/68430/98164/Practical_introduction_to_PCI_Express_with_FPGAs_-_Extended.pdf) [slides]

[2017: "Introduction to PCI Express" by Paolo Durante](https://indico.cern.ch/event/643308/contributions/2610541/attachments/1467727/2537467/Introduction_to_PCI_Express.pdf) [slides]

2015: "Overview of PCI(e) Subsystem" by Kishon Vijay Abraham [[slides](http://events17.linuxfoundation.org/sites/events/files/slides/Overview_Of_Pci_Subsystem.pdf)] [[video](https://www.youtube.com/watch?v=uccPR6X8vy8)]

[2015: "Does PCIe hotplug actually work in practice?"](https://electronics.stackexchange.com/questions/208767/does-pcie-hotplug-actually-work-in-practice) [stackoverflow]

[2012: "Thunderbolt Technology"](https://www.intel.com/content/dam/doc/technology-brief/thunderbolt-technology-brief.pdf) [article]

## Attacks

["Security | DMA | Hacking" by Ulf Frisk](http://blog.frizk.net/) [blog]

[Ulf Frisk](https://twitter.com/ulffrisk) [twitter]

[Dmytro Oleksiuk](https://twitter.com/d_olex) [twitter]

[2022: "PCIe DMA Attack against a secured Jetson Nano (CVE-2022-21819)"](https://www.thegoodpenguin.co.uk/blog/pcie-dma-attack-against-a-secured-jetson-nano-cve-2022-21819/) [article]

[2021: Dumping the Sonos One Smart Speaker](https://www.synacktiv.com/en/publications/dumping-the-sonos-one-smart-speaker) [article]

[2021: "Modifying the Acorn CLE-215+ FPGA into a PCILeech DMA attack device"](https://blog.frizk.net/2021/10/acorn.html) [article]

[2021: "PCIe Device Attacks: Beyond DMA"](https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-PCIe-Device-Attacks-Beyond-DMA-Exploiting-PCIe-Switches-Messages-And-Errors.pdf) [slides]

[2020: "Things not to do when using an IOMMU by Ilja van Sprundel and Joseph Tartaro"](https://www.youtube.com/watch?v=p1HUpSkHcZ0) [video]

[2020: "IOMMU and DMA attacks" by Jean-Christophe Delaunay](https://www.synacktiv.com/ressources/IOMMU_and_DMA_attacks_presentation.pdf) [slides] [[video](https://www.youtube.com/watch?v=u94ioghxKoc)]

[2020: "IOMMU-resistant DMA attacks" by Gil Kupfer](http://www.cs.technion.ac.il/users/wwwb/cgi-bin/tr-get.cgi/2018/MSC/MSC-2018-21.pdf) [thesis]

[2020: "DIRECT MEMORY ACCESS ATTACKS: A WALK DOWN MEMORY LANE"](https://eclypsium.com/wp-content/uploads/2020/01/DMA-Attacks-A-Walk-Down-Memory-Lane.pdf) [article]

[2020: "Introductory Study of IOMMU (VT-d) and Kernel DMA Protection on Intel Processors" by Satoshi Tanda](https://standa-note.blogspot.com/2020/05/introductory-study-of-iommu-vt-d-and.html) [article]

[2019: "IOMMU and DMA attacks" by Jean-Christophe Delaunay](https://www.synacktiv.com/ressources/IOMMU_and_DMA_attacks_presentation_16_9.pdf) [slides]

[2019: "PicoDMA - DMA Attacks at your fingertips" by Ben Blaxill and Joel Sandin](https://i.blackhat.com/USA-19/Wednesday/us-19-Sandin-PicoDMA-DMA-Attacks-At-Your-Fingertips.pdf) [slides]

[2019: "Prevent DMA attacks from untrusted devices" by Lu Baolu](https://linuxplumbersconf.org/event/4/contributions/414/attachments/393/636/LPC2019-Prevent_DMA_attacks_from_untrusted_devices.pdf) [slides]

[2019: "Exploitation from malicious PCI Express peripherals" by Colin Rothwell](https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-934.pdf) [thesis]

[2019: "Thunderclap: Exploring Vulnerabilities in Operating System IOMMU Protection via DMA from Untrustworthy Peripherals"](http://thunderclap.io/thunderclap-paper-ndss2019.pdf) [paper]

[2018: "PRACTICAL DMA ATTACK ON WINDOWS 10" by Jean-Christophe Delaunay](https://www.synacktiv.com/posts/pentest/practical-dma-attack-on-windows-10.html) [article]

[2018: "Kernel DMA Protection for Thunderbolt 3"](https://docs.microsoft.com/en-us/windows/security/information-protection/kernel-dma-protection-for-thunderbolt) [article]

[2018: "BitLocker Countermeasures"](https://docs.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-countermeasures) [article]

[2018: "Thunderbolt 3 and Security on Microsoft Windows® 10 Operating system"](https://thunderbolttechnology.net/security/Thunderbolt%203%20and%20Security.pdf) [article]

2017: "Public FPGA based DMA Attacking" by Ulf Frisk [[slides](https://github.com/ufrisk/presentations/blob/master/34C3-Ulf-Frisk-Public-FPGA-Based-DMA-Attacking.pdf)] [[video](https://www.youtube.com/watch?v=XcEYkcwbRX8)]

2017: "Evil devices and direct memory attacks" by Ulf Frisk [[slides](https://github.com/ufrisk/presentations/blob/master/SEC-T-0x0Anniversary-Ulf-Frisk-Evil-Devices-and-Direct-Memory-Attacks.pdf)] [[video](https://www.youtube.com/watch?v=WR7hDKbGiX8)]

[2017: "Introducing bolt: Thunderbolt 3 security levels for GNU/Linux" by Christian Kellner](https://christian.kellner.me/2017/12/14/introducing-bolt-thunderbolt-3-security-levels-for-gnulinux/) [article]

2017: "Getting Physical With USB Type-C" by Alex Ionescu [[slides](http://alex-ionescu.com/publications/Recon/recon2017-bru.pdf)] [[video](https://www.youtube.com/watch?v=RSV3f6aEJFY)]

[2017: "A Tour Beyond BIOS: Using IOMMU for DMA Protection in UEFI Firmware"](https://firmware.intel.com/sites/default/files/Intel_WhitePaper_Using_IOMMU_for_DMA_Protection_in_UEFI.pdf) [paper]

[2017: "The True Story of Windows 10 and the DMA-protection" by Sami Laiho](http://blog.win-fu.com/2017/02/the-true-story-of-windows-10-and-dma.html) [article]

[2017: "PCI EXPRESS: ВЗГЛЯД DIY-РАЗРАБОТЧИКА И ХАКЕРА" by Dmytro Oleksiuk](https://github.com/Cr4sh/s6_pcie_microblaze/blob/master/docs/PCI-E%20Security%20-%20Slides%20%5BRUS%5D.pdf) [slides]

2017: "Taking DMA Attacks to the Next Level" by Anna Trikalinou and Dan Lake [[slides](https://www.blackhat.com/docs/us-17/wednesday/us-17-Trikalinou-Taking-DMA-Attacks-To-The-Next-Level-How-To-Do-Arbitrary-Memory-Reads-Writes-In-A-Live-And-Unmodified-System-Using-A-Rogue-Memory-Controller.pdf)] [[video](https://www.youtube.com/watch?v=QeIPcA8zsHk)]

[2016: "Bypassing IOMMU Protection against I/O Attacks"](https://hal.archives-ouvertes.fr/hal-01419962/document) [paper]

2016: "Direct Memory Attack the Kernel" by Ulf Frisk [[slides](https://github.com/ufrisk/presentations/blob/master/DEFCON-24-Ulf-Frisk-Direct-Memory-Attack-the-Kernel-Final.pdf)] [[video](https://www.youtube.com/watch?v=fXthwl6ShOg)]

[2015: "Breaking UEFI security with software DMA attacks" by Dmytro Oleksiuk](http://blog.cr4.sh/2015/09/breaking-uefi-security-with-software.html) [article]

2015: "NSA Playset: PCIe" by Joe FitzPatrick and Miles Crabill [[video](https://www.youtube.com/watch?v=OD2Wxe4RLeU)] [[slides](https://www.defcon.org/images/defcon-22/dc-22-presentations/Fitzpatrick-Crabill/DEFCON-22-Joe-FitzPatrick-Miles-Crabill-NSA-Playset-PCIe.pdf)]

2013: "Funderbolt: Adventures in Thunderbolt DMA Attacks" by Russ Sevinsky [[slides](https://media.blackhat.com/us-13/US-13-Sevinsky-Funderbolt-Adventures-in-Thunderbolt-DMA-Attacks-Slides.pdf)] [[video](https://www.youtube.com/watch?v=V9TKP_ZIur8)]

[2010: "Memory Forensics over the IEEE 1394 Interface" by Freddie Witherden](https://freddie.witherden.org/pages/ieee-1394-forensics.pdf) [paper]

## Other

[2023: PCI Express To Hell](https://www.youtube.com/watch?v=fE0fnGbI8B8)

[2021: "Fuzzing Linux with Xen" by Tamas K Lengyel](https://media.defcon.org/DEF%20CON%2029/DEF%20CON%2029%20presentations/Tamas%20K%20Lengyel%20-%20Fuzzing%20Linux%20with%20Xen.pdf) [slides] [[video](https://www.youtube.com/watch?v=_dXC_I2ybr4)

[2021: "An Introduction to IOMMU Infrastructure in the Linux Kernel"](https://lenovopress.lenovo.com/lp1467.pdf) [article]

[2020: "IOMMU Support in Linux"](https://www.cerno.tech/posts/2020/08/iommu-support-in-linux/) [article]

## Tools

https://github.com/ufrisk/pcileech

https://github.com/Cr4sh/s6_pcie_microblaze

http://thunderclap.io/

https://github.com/NSAPlayset/SLOTSCREAMER

https://github.com/carmaa/inception

https://github.com/defparam/BAR-Tender
